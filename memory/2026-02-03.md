# 2026-02-03

## Ansun 开发记录

### 巨鲸追踪功能
- 新增 `/api/chain/whale-dashboard` 接口，返回：
  - btc_transactions / eth_transactions（大额转账）
  - whale_holdings（巨鲸持仓）
  - exchange_flows（交易所流入/流出）
  - onchain_metrics（链上指标）

### Bug修复
- **SyntaxError in chain.js**: JavaScript 对象 key 不能用 `exchange_inflow` 格式
- 修复: 改为 camelCase (`exchangeInflow`, `inflow24h`, `activeAddresses`, `nftVolume` 等)

### PWA 支持
- 添加 `manifest.json`: 可安装到手机桌面
- 添加 `sw.js`: Service Worker 离线缓存
- 添加安装按钮: 移动端显示 "📲 Install"
- 支持 iOS Safari 添加到主屏幕

### 快捷跳转
- 点击 Unlocks → 跳转到 Upcoming Unlocks 板块
- 点击 Narratives → 跳转到 Hot Narratives 板块
- 点击 Whale Tx → 跳转到 Whale Tracking 板块
- 点击 DeFi TVL → 跳转到 Live Market 板块
- 平滑滚动动画效果

### AI 信号系统
- 巨鲸活动分析 (60%权重): 监控 CZ/Justin Sun/Binance 等地址
- 新闻情绪分析 (40%权重): 关键词情感分析
- 综合信号: 买入/卖出/持有
- 置信度显示
- 币种选择器: BTC/ETH/SOL/BNB/XRP/ADA/DOGE/AVAX
- API: `/api/signal/coin/:symbol`

### 新增功能 (2026-02-04)
1. **巨鲸实时追踪**
   - CZ/Vitalik/SBF/Justin Sun 地址监控
   - 🔴 重大 (> $10M) / 🟠 大额 (> $1M) / 🟡 监控 分类
   - 实时提醒: 大额转账 1秒内显示
   - API: `/api/whale/alerts`

2. **概念轮动仪表盘**
   - AI + Crypto / RWA / DeFi / Layer 2 / Memecoin / Restaking
   - 🔥 热门 / 📈 上升 / 📉 降温 / ➡️ 稳定
   - AI 洞察建议
   - API: `/api/whale/narratives`

3. **个性化信息流**
   - 关注最多 5 个币种
   - 只看关注的新闻和巨鲸动态
   - localStorage 本地存储
   - API: `/api/whale/feed`

4. **贵金属行情**
   - 🥇 黄金 (XAU/USD) 实时价格
   - 🥈 白银 (XAG/USD) 实时价格
   - 🔔 价格提醒设置
   - API: `/api/gold/all`

5. **自动交易框架**
   - ⚠️ 风险提示（必须同意才能使用）
   - 🔗 Binance API 配置
   - 支持主网和测试网 (testnet)
   - 策略: 网格交易 / 均线交叉 / RSI 策略
   - API: `/api/trading/config`

### 新增 API
- `/api/whale/alerts` - 巨鲸实时提醒
- `/api/whale/narratives` - 概念轮动分析
- `/api/whale/feed` - 个性化信息流
- `/api/gold/all` - 贵金属行情
- `/api/trading/config` - 交易配置
- `/api/trading/strategy` - 策略配置
- `/api/trading/positions` - 当前持仓
- `/api/trading/backtest` - 策略回测

### 部署
- Git push → SSH → pm2 restart
- 服务状态: online @ ansun.space

### 用户反馈修复
- **快捷卡片点击跳转**: 点击"代币解锁"等快捷卡片可跳转到对应 Tab
- **概念轮动界面**: 重新设计为更直观的卡片式布局，包含热度条、趋势、操作建议
- **新 Tab 导航**: 信号/巨鲸/黄金/交易/概念/关注

### 用户需求
- 用户希望做黄金自动交易 → 已实现框架，但未接入真实 API
- ⚠️ 提醒：自动交易涉及真实资金，需使用测试网验证
